<!DOCTYPE html>
<html lang="en">
<head>
  <title>PHYSCI 70: Intro to Digital Fabrication</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?lang=css&amp;skin=sons-of-obsidian"></script>

  <link href="../style.css" rel="stylesheet">
</head>
<body>
  <header>
    <h1 class="logo">PS70: Intro to Digital Fabrication</h1>
    <input type="checkbox" id="nav-toggle" class="nav-toggle">
    <nav>
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../about.html">About</a></li>
        <li><a href="../00_final_project/index.html">Final Project</a></li>
      </ul>
    </nav>
    <label for="nav-toggle" class="nav-toggle-label">
      <span></span>
    </label>
  </header>
  <br>
  <br>
  <div class="container-fluid">

    <div class="row">
      <div class="column-sm">
        <h3>Final Project Proposition: The Pasta Machine</h3> 
      </div>
      <div class="column-lg">
        <img src="./plans.png" class="img-responsive margin" style="width: 100%">

        <h3>Some considerations:</h3>
        <ul>
          <li>To make the gears, I'm thinking that I'll 3D print them - they need to be pretty sturdy and they're large enough that I'm not concerned about precision.</li>
          <li>I'm still trying to work out the horizontal motion of the mobile roller. Maybe if I find a way to really fasten it at a right angle to a joint on one side, and then my moving one side I'll be able to move the entire thing, but this seems kind of difficult.</li>
          <li>Hopefully, I'll be able to hook it up to an app, and make it so that you can plug in the machine. Then, you can write on the app what thickness you are starting with, what you want to end with, and the machine will automatically adjust in between. Optimally, it'd be able to detect when dough is being fed through it, but that seems like something I'd add in later. Another option is obviously to just have the user click a button every time they want to adjust (some sort of up/down button to control the precision by set increments, and an option to type in the exact thickness). Probably easier to start with this.</li>
          <li>Again, the horizontal motion is going to be a pain. I could use capacitance sensors to try to implement the distance measuring, but it might be easier to just calibrate whatever method I'm using and work off of that.</li>
          <li>I've been looking at other pasta machines, and a lot of them have 'scrapers' that help clean the rollers of dough as they turn. I think I might try to make some, maybe out of thin sheets of metal, but that will obviously be difficult to manipulate with my current setup.</li>
        </ul>
        <h3>Materials:</h3>
        <ul>
          <li>I'm using 1 1/4 inch PVC pipes for the roller. Optimally, it'd be stainless steel or copper or something more foodsafe, but I can't really manipulate that.</li>
          <li>The gear parts will be 3D printed, and there are 4 gears: one attached to the motor (hoping to incorporate the motor coupler and the gear in the same 3D printed piece), and three others. They need to mesh in groups of 2. They will all be spur gears, for simplicity (I considered helical gears but that also seems too complicated, and I want a lot of flexibility with the mesh.)</li>
          <li>I'm going to use 2 blocks of pine for the sides, it will be easy to drill holes and attach components. And easy to find!</li>
          <li>I'll be using some tire rods to hold the sides together, along with some nuts. Not necessarily the most beautiful solution (it'd be nicer to take a rod of stainless, size it exactly, thread it, and drill a screw into it to fasten), but it's easy!</li>
        </ul>

        <p>Here is a download of the fusion 360 design file: <a href="./basic_parts.f3d" download> dowload here </a></p>
        <p>The first step was to make a mockup in Fusion360, and 3D print the pieces as needed. I used a gear generator to make the gears, and imported McMaster pieces for the hardware pieces I needed.</p>

        <img src="./final/left.png" class="img-responsive margin" style="width: 100%">
        <img src="./final/right.png" class="img-responsive margin" style="width: 100%">
        <p>I also mocked up some cutters that would cut the pasta into interesting shapes when put on the rollers: pictured here are the straight cutter, the squiggly cutter, and the hear ravioli. The heart ravioli wasn't printed, because it would have required too much finessing, but theoretically ig you put a solid cylinder behind it it wouldn't be that hard.</p>
        <img src="./final/cut.png" class="img-responsive margin" style="width: 100%">
        <p>Finally, the pieces were printed and sent over to me!</p>
        <img src="./final/pieces.jpg" class="img-responsive margin" style="width: 100%">
        <p>Then, the assembly process began.</p>
        <p>I used a paper to mockup where all the holes had to go, then I used the paper template to drill in the right spots.</p>
        <img src="./final/paper.jpg" class="img-responsive margin" style="width: 100%">
        <img src="./final/dry.jpg" class="img-responsive margin" style="width: 100%">
        <p>I attached the motors:</p>
        <img src="./final/progress.jpg" class="img-responsive margin" style="width: 100%">

        <img src="./final/progresss.jpg" class="img-responsive margin" style="width: 100%">
        <img src="./final/profile.jpg" class="img-responsive margin" style="width: 100%">
        
        <p>Much to my surprise, the whole width adjustment mechanism worked very well: essentially, there was a nut gluedinto a collar, which guided a lead screw.</p>
        <img src="./final/glue.jpg" class="img-responsive margin" style="width: 100%">
        <img src="./final/width.jpg" class="img-responsive margin" style="width: 100%">
        <p>Then, I just carried the wiring across:</p>
        <img src="./final/prefix.jpg" class="img-responsive margin" style="width: 100%">
        <p>I also had to work on ways to attach wire without any soldering, using pliers, twisting and some electrician's tape:</p>
        <img src="./final/tri.jpg" class="img-responsive margin" style="width: 100%">
        <p>I used a hacksaw to cut my board down, and sealed the side with some electrician's tape. I also neatened up my circuits.</p>
        <img src="./final/boardcut.jpg" class="img-responsive margin" style="width: 100%">
        <img src="./final/boardmetal.jpg" class="img-responsive margin" style="width: 100%">
        <img src="./final/wiring.jpg" class="img-responsive margin" style="width: 100%">
        <p>And then it was done!</p>
        <img src="./final/final.jpg" class="img-responsive margin" style="width: 100%">
        <img src="./final/side.jpg" class="img-responsive margin" style="width: 100%">
        <img src="./final/otherside.jpg" class="img-responsive margin" style="width: 100%">
        <img src="./final/best.jpg" class="img-responsive margin" style="width: 100%">
                <img src="./final/diagram.png" class="img-responsive margin" style="width: 100%">

        <p>There were three codes: one for each of the driver boards and one for the Huzzah.</p>
        <pre class="prettyprint"><code class="language-arduino">
          /*
          Stepper program to control stepper board with digital IO control.  Ouput pins:  step_comm makes motor step on rise.
          dir_comm determines motor direction.  Make sure these signals are , ~3.5 V for ATSAM motor driver boards.
          */
          #include &lt;WiFi.h&gt;                                 // esp32 library
          #include &lt;FirebaseESP32.h&gt;                        // firebase library
          #define RXD2 16
          #define TXD2 17
          #define FIREBASE_HOST "pastamachine-a1af1.firebaseio.com"  // the project name address from firebase id
          #define FIREBASE_AUTH "cVK2a9h78168CPmRaXcoFcx0oLA3Ad0A0a5UFXwT"                          // the secret key generated from firebase
          #define WIFI_SSID "exede-5184"                                // input your home or public wifi name
          #define WIFI_PASSWORD "E0AF8CD047"                            // password of wifi ssid
          String fireString = "";                                          // led status received from firebase
          String speeds = "0";
          String thickness = "0";
          String lengths = "0";
          String directions = "down";
          String statuss = "off";
          int step_comm = 32;      //pin 3 of the 2x2 header
          int dir_comm = 15;       //pin 4 of the 2x2 header
          int step_count = 0;
          boolean dir = false;
          int converts = 0;
          String current_width = "0";
          float range = 12;
          int steps = 0;
          int total_step = 24*200;

          FirebaseData firebaseData;
          FirebaseData firebase_thickness;
          FirebaseData firebase_length;
          FirebaseData firebase_speed;
          FirebaseData firebase_status;
          FirebaseData firebase_direction;
          FirebaseData firebase_current;



          void setup() {  
          Serial.begin(9600);      //the USB serial, for monitoring the step number.
          Serial2.begin(9600, SERIAL_8N1, RXD2, TXD2);
          pinMode(step_comm, OUTPUT);
          pinMode(dir_comm, OUTPUT);
          WiFi.begin(WIFI_SSID, WIFI_PASSWORD);                          // try to connect with wifi
          Serial.print("Connecting to ");
          Serial.print(WIFI_SSID);
          while (WiFi.status() != WL_CONNECTED) {
          Serial.print(".");
          delay(500);
        }
        Serial.println();
        Serial.print("Connected to ");
        Serial.println(WIFI_SSID);
        Serial.print("IP Address is : ");
        Serial.println(WiFi.localIP());                                // print local IP address
        Firebase.begin(FIREBASE_HOST, FIREBASE_AUTH);                  // connect to firebase
        Firebase.reconnectWiFi(true);
        //Firebase.set(firebaseData, "/LED_STATUS", "OFF");              // set initial string of "OFF"


      }


      void loop() {
      if(Firebase.getString(firebaseData, "/thickness"))
      {
        //Success
        Serial.print("Get int data success, int = ");
        thickness = firebaseData.stringData();
        Serial.println(thickness);

      }else{
      //Failed?, get the error reason from firebaseData

      Serial.print("Error in getInt, ");
      Serial.println(firebaseData.errorReason());
    }
    Firebase.getString(firebaseData, "/current_width");
    current_width = firebaseData.stringData();
    Firebase.getString(firebaseData, "/speed");                     // get led status input from firebase
    speeds = firebaseData.stringData();                        // change to e.g. intData() or boolData()
    Firebase.getString(firebase_status, "/status");
    statuss = firebase_status.stringData();
    Firebase.getString(firebase_direction, "/direction");                     // get led status input from firebase
    directions = firebase_direction.stringData();                        // change to e.g. intData() or boolData()
    Firebase.getString(firebase_length, "/length");
    lengths = firebase_length.stringData();
    Serial.print("Current width is ");
    Serial.println(current_width);
    Serial.print("speed is ");
    Serial.println(speeds);
    Serial.print("status is ");
    Serial.println(statuss);
    Serial.print("direction is ");
    Serial.println(directions);
    Serial.print("length is ");
    Serial.println(lengths);

    //write DC instructions based on speed, status and direction
    if(statuss == "on"){
    if(directions == "up"){
    converts = speeds.toInt() + 128;
  }
  else{
  converts = speeds.toInt();
}
Serial2.write(converts);
}
else{
Serial2.write(0);
}

if(current_width != thickness){
Serial2.write(0);
if (current_width.toInt() &lt; thickness.toInt()){
dir = false;
steps = (thickness.toInt() - current_width.toInt())/(range)*total_step;
Serial.println("getting bigger");
Serial.println(steps);

}
else{
dir = true;
steps = (current_width.toInt() - thickness.toInt())/(range)*total_step;
Serial.println("getting closer");
Serial.println(steps);
}
digitalWrite(dir_comm,dir);
for(int i = 0; i &lt; steps; i++){ 
digitalWrite(step_comm,HIGH);
delay(1);
digitalWrite(step_comm,LOW);
delay(20);    //delay to allow motor to step and settle.
Serial.println(steps);
Serial.println(steps/200);

}  //end i loop
current_width = thickness.toInt();
Firebase.set(firebaseData, "/current_width", String(current_width));
}
// write stepper instructions based on current width and goal width

}   //end of loop function.

</code></pre>
<p>And here is the code for the stepper motor board:</p>
<pre class="prettyprint"><code class="language-arduino">
  /*
  Stepper program.  Input pins for direction and step.  Steps when step-pin goes high.
  Make sure that the incoming digital signal is < 3.5 volts to protect ATSAM chip.
  */


  int Aplus = 15;
  int Aminus = 14;
  int Bplus = 8;
  int Bminus = 5;
  int led1_pin = 2;
  int led2_pin = 4;

  int step_pin = 30;      //pin 3 of the 2x2 header
  int dir_pin = 31;       //pin 4 of the 2x2 header
  uint16_t step_count = 0;

  void setup() {  
  Serial.begin(0);      //the USB serial, for monitoring the step number.
  pinMode(Aplus, OUTPUT);
  pinMode(Aminus, OUTPUT);
  pinMode(Bplus, OUTPUT);
  pinMode(Bminus, OUTPUT);
  pinMode(step_pin, INPUT_PULLDOWN);
  pinMode(dir_pin, INPUT_PULLDOWN);
  pinMode(led1_pin, OUTPUT);
  pinMode(led2_pin, OUTPUT);
  digitalWrite(led1_pin, HIGH);
  digitalWrite(led2_pin, HIGH);

  //
  //Following are the functions that energize the coils for driving.  They are executed in positive or negative sequence
  //

}

void pulse_0(){
digitalWrite(Aplus,HIGH);
digitalWrite(Bplus,HIGH);
}

void pulse_1(){
digitalWrite(Aminus,HIGH);
digitalWrite(Bplus,HIGH);
}

void pulse_2(){
digitalWrite(Aminus,HIGH);
digitalWrite(Bminus,HIGH);
}

void pulse_3(){
digitalWrite(Aplus,HIGH);
digitalWrite(Bminus,HIGH);
}

void all_off() {
digitalWrite(Aplus,LOW);
digitalWrite(Aminus,LOW);
digitalWrite(Bplus,LOW);
digitalWrite(Bminus,LOW);
}

void loop() {

while(!digitalRead(step_pin)){      //wait for step pin to go high.
;} 

//  digitalWrite(led1_pin,HIGH);
all_off();                          //turn off coils before sending new step.

if (digitalRead(dir_pin)){      //check direction.
// digitalWrite(led2_pin,HIGH);
step_count --;
}
else{
step_count ++;
digitalWrite(led2_pin,LOW);
}


step_count = step_count%4;
Serial.println(step_count); 

if (step_count == 0) pulse_0();
if (step_count == 1) pulse_1();
if (step_count == 2) pulse_2();
if (step_count == 3) pulse_3();  
delay(2);
//digitalWrite(led1_pin,LOW);

}
</code></pre>
<pre class="prettyprint"><code class="language-arduino">
  /*
  Stepper program.  USART sends number of steps.  Steps at a constant rate.
  */
  int motor_speed;
  int Aplus = 15;
  int Aminus = 14;
  int led1_pin = 2;
  int led2_pin = 4;
  int Bplus = 8;
  int Bminus = 5;

  void setup() {
  Serial1.begin(9600);
  Serial.begin(0);
  pinMode(led1_pin, OUTPUT);
  pinMode(led2_pin, OUTPUT);
  digitalWrite(led1_pin, HIGH);
  digitalWrite(led2_pin, HIGH);
  pinMode(Aplus, OUTPUT);
  pinMode(Aminus, OUTPUT);
  pinMode(Bplus, OUTPUT);
  pinMode(Bminus, OUTPUT);
}



void loop() {

while (!Serial1.available()){
}


int rec_byte =  Serial1.read();

Serial.println(rec_byte);
if (rec_byte &gt;= 128){
motor_speed = (rec_byte-128)*2;
digitalWrite(led1_pin, HIGH);
digitalWrite(led2_pin, LOW);
analogWrite(Aminus,0);
analogWrite(Aplus, motor_speed);
analogWrite(Bminus,0);
analogWrite(Bplus, motor_speed);
}

else {
motor_speed = (128-rec_byte)*2;
analogWrite(Aplus,0);
analogWrite(Aminus, motor_speed);
digitalWrite(led1_pin, LOW);
digitalWrite(led2_pin, HIGH);
analogWrite(Bplus,0);
analogWrite(Bminus, motor_speed);
}
}
</code></pre>
<p>Finally, here is the website code:</p>
<pre class="prettyprint"><code class="language-html">
  &lt;!doctype html&gt;
  &lt;html class="no-js" lang="en"&gt;
  &lt;head&gt;
  &lt;meta charset="utf-8" /&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
  &lt;link rel="stylesheet" type="text/css" href="style.css"&gt;
  &lt;script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"&gt;&lt;/script&gt;
  &lt;link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"&gt;
  &lt;script src="my.js"&gt;&lt;/script&gt;
  &lt;link href="Content/bootstrap.css" rel="stylesheet" /&gt;

  &lt;script src="Scripts/jquery-1.11.0.min.js"&gt;&lt;/script&gt;
  &lt;script src="Scripts/bootstrap.min.js"&gt;&lt;/script&gt;
  &lt;title&gt;PS70&lt;/title&gt;
  &lt;/head&gt;

  &lt;body&gt;
  &lt;h1&gt;The Pasta Machine&lt;/h1&gt;
  &lt;div class="container"&gt;
  &lt;div class="row"&gt;
  &lt;div class="column-sm"&gt;



  &lt;br /&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;h1&gt;Roller Speed&lt;/h1&gt;&lt;br&gt;
  &lt;div id="up_down"&gt;
  &lt;button id="turn-up" data-answer="true"&gt;Up&lt;/button&gt;
  &lt;button id="turn-down" data-answer="false"&gt;Down&lt;/button&gt;
  &lt;/div&gt;
  &lt;br&gt;
  &lt;input id="speed" type="range"  min="1" max="100" value="50" link-to="text_box_name"&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;input type="text" id="text_box_name"&gt; &lt;br&gt;&lt;br&gt;
  &lt;div id="on_off"&gt;
  &lt;button id="turn-on" name="turnon"&gt;On &lt;/button&gt;
  &lt;button id="turn-off" name="turnoff"&gt;Off &lt;/button&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;br&gt;
  &lt;div class="column-sm"&gt;

  &lt;h1&gt;Thickness&lt;/h1&gt;&lt;br&gt;
  &lt;input id="thickness" type="range"  min="1" max="16" value="8" link-to="text_box_name2"&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;input type="text" id="text_box_name2"&gt; &lt;p&gt;/16''&lt;/p&gt;&lt;br&gt;
  &lt;p&gt;Chosen width:&lt;/p&gt;
  &lt;p id="result"&gt;&lt;span id="min"&gt;&lt;/span&gt;/&lt;span id="max"&gt;&lt;/span&gt;"&lt;/p&gt;
  &lt;/div&gt;
  &lt;/div&gt;

  &lt;div class="row"&gt;
  &lt;h1&gt;Presets&lt;/h1&gt;
  &lt;div class="col-sm-6"&gt;
  &lt;h2&gt;Edit&Select Presets&lt;/h2&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="row"&gt;
  &lt;div class="col-sm-6"&gt;
  &lt;table id="productTable"
  class="table table-bordered table-condensed table-striped"&gt;
  &lt;thead&gt;
  &lt;tr&gt;
  &lt;th&gt;Edit&lt;/th&gt;
  &lt;th&gt;Preset Name&lt;/th&gt;
  &lt;th&gt;Thickness (/16")&lt;/th&gt;
  &lt;th&gt;Length (")&lt;/th&gt;
  &lt;th&gt;Delete&lt;/th&gt;
  &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;/table&gt;
  &lt;/div&gt;
  &lt;/div&gt;

  &lt;div class="row"&gt;
  &lt;div class="col-sm-6"&gt;
  &lt;div class="panel panel-primary"&gt;
  &lt;div class="panel-heading"&gt;
  Preset Information
  &lt;/div&gt;
  &lt;div class="panel-body"&gt;
  &lt;div class="form-group"&gt;
  &lt;label for="presetname"&gt;
  Preset Name
  &lt;/label&gt;
  &lt;input type="text"
  class="form-control"
  value="Preset Name"
  id="presetname" /&gt;
  &lt;/div&gt;
  &lt;div class="form-group"&gt;
  &lt;label for="preset_thickness"&gt;
  Thickness
  &lt;/label&gt;
  &lt;input type="number"
  class="form-control"
  value="5"
  id="preset_thickness" /&gt;
  &lt;/div&gt;
  &lt;div class="form-group"&gt;
  &lt;label for="preset_length"&gt;
  Length
  &lt;/label&gt;
  &lt;input type="number"
  class="form-control"
  value="2"
  id="preset_length" /&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class="panel-footer"&gt;
  &lt;div class="row"&gt;
  &lt;div class="col-xs-12"&gt;
  &lt;button type="button" id="updateButton"
  class="btn btn-primary"
  onclick="productUpdate();"&gt;Add&lt;/button&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;/div&gt;

  &lt;/div&gt;

  &lt;!-- &lt;script src="https://www.gstatic.com/firebasejs/7.14.3/firebase.js"&gt;&lt;/script&gt; --&gt;
  &lt;!-- The core Firebase JS SDK is always required and must be listed first --&gt;
  &lt;script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-app.js"&gt;&lt;/script&gt;

  &lt;!-- TODO: Add SDKs for Firebase products that you want to use
  https://firebase.google.com/docs/web/setup#available-libraries --&gt;
  &lt;script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-analytics.js"&gt;&lt;/script&gt;
  &lt;script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-auth.js"&gt;&lt;/script&gt;
  &lt;script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-database.js"&gt;&lt;/script&gt;
  &lt;script src="https://www.gstatic.com/firebasejs/7.14.3/firebase-storage.js"&gt;&lt;/script&gt;

  &lt;script&gt;
  // Your web app's Firebase configuration
  var firebaseConfig = {
  apiKey: "AIzaSyAgyv8N0t0Uef3vrGuv3wQ2fOpm5WA27qE",
  authDomain: "pastamachine-a1af1.firebaseapp.com",
  databaseURL: "https://pastamachine-a1af1.firebaseio.com",
  projectId: "pastamachine-a1af1",
  storageBucket: "pastamachine-a1af1.appspot.com",
  messagingSenderId: "795329952205",
  appId: "1:795329952205:web:6b5ade4d8dcc5de2f76c84",
  measurementId: "G-187H9XBX1Q"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);
firebase.analytics();
window.onload=function(){

document.getElementById('turn-on').addEventListener('click', turnOn, false);
document.getElementById('turn-off').addEventListener('click', turnOff, false);
document.getElementById('turn-up').addEventListener('click', turnUp, false);
document.getElementById('turn-down').addEventListener('click', turnDown, false);
};
&lt;/script&gt;

&lt;/body&gt;

</code></pre>
<p>Here is the JS:</p>
<pre class="prettyprint"><code class="language-js">
  var precision = 16;
var editRow = null;
window.onload=function(){
  window.ref = firebase.database().ref();
}

function reduce(numerator,denominator){
  var gcd = function gcd(a,b){
    return b ? gcd(b, a%b) : a;
  };
  gcd = gcd(numerator,denominator);
  return [numerator/gcd, denominator/gcd];
}
$(function() {
  var ref = firebase.database().ref();

  $('input').filter( function(){return this.id == 'speed' } ).each(function(){  
    var $slider = $(this),
    $text_box = $('#'+$(this).attr('link-to'));
    
    $text_box.val(this.value);
    
    $slider.change(function(){
      $text_box.val(this.value);
      ref.update({
        "speed": $text_box.val()
      });
    });
    
    $text_box.change(function(){
      $slider.val($text_box.val());
      ref.update({
        "speed": $text_box.val()
      });
    });

  });
});

$(function() {
  $('input').filter( function(){return this.id == 'thickness' } ).each(function(){  
      var ref = firebase.database().ref();

    var $slider = $(this),
    $text_box = $('#'+$(this).attr('link-to'));
    
    $text_box.val(this.value);
    document.getElementById("min").innerHTML = 1;
    document.getElementById("max").innerHTML = 2;
    $slider.change(function(){
      $text_box.val(this.value);
      var val = reduce($text_box.val(), precision);
      document.getElementById("min").innerHTML = val[0];
      document.getElementById("max").innerHTML = val[1];
      ref.update({
        "thickness": $text_box.val()
      });
    });
    
    $text_box.change(function(){
      $slider.val($text_box.val());
      var val = reduce($text_box.val(), precision);
      document.getElementById("min").innerHTML = val[0];
      document.getElementById("max").innerHTML = val[1];
      ref.update({
        "thickness": $text_box.val()
      });
    });

  });
});


// Reduce a fraction by finding the Greatest Common Divisor and dividing by it.

$(function() {
  var bindButtons = function(){

    $('#on_off').on('click', 'button', function( e ){

      e.preventDefault();

      $(this)
      .addClass('selected')
      .removeClass('disabled')
      .siblings()
      .removeClass('selected')
      .addClass('disabled');
    });

  };

// Init binding
bindButtons();

// Get your answer
var answer = $('#buttons .selected').data('answer');
});

$(function() {
  var bindButtons = function(){

    $('#up_down').on('click', 'button', function( e ){

      e.preventDefault();

      $(this)
      .addClass('selected')
      .removeClass('disabled')
      .siblings()
      .removeClass('selected')
      .addClass('disabled');
    });

  };

// Init binding
bindButtons();

// Get your answer
var answer = $('#buttons .selected').data('answer');
});

$(function() {
  

});

function turnOn(){
    var ref = firebase.database().ref();
    console.log("turning on");
    ref.update({
      "status": "on"
    });
  }

  function turnOff(){
    var ref = firebase.database().ref();
    console.log("turning off");
    ref.update({
      "status": "off"
    });
  } 

  function turnUp(){
    var ref = firebase.database().ref();
    console.log("turning up");
    ref.update({
      "direction": "up"
    });
  }

  function turnDown(){
    var ref = firebase.database().ref();
    console.log("turning down");
    ref.update({
      "direction": "down"
    });
  } 

// Current product being edited
var editRow = null;

function productDisplay(ctl) {
  editRow = $(ctl).parents("tr");
  var cols = editRow.children("td");

  $("#productname").val($(cols[1]).text());
  $("#introdate").val($(cols[2]).text());
  $("#url").val($(cols[3]).text());

      // Change Update Button Text
      $("#updateButton").text("Update");
  }

function productUpdate() {
    if ($("#updateButton").text() == "Update") {
      productUpdateInTable();
    }
    else {
      productAddToTable();
    }

      // Clear form fields
      formClear();

      // Focus to product name field
      $("#productname").focus();
  }

    // Add product to &lt;table&gt;
    function productAddToTable() {
      // First check if a &lt;tbody&gt; tag exists, add one if not
      if ($("#productTable tbody").length == 0) {
        $("#productTable").append("&lt;tbody&gt;&lt;/tbody&gt;");
      }

      // Append product to table
      $("#productTable tbody").append(
        productBuildTableRow());
  }

    // Update product in &lt;table&gt;
    function productUpdateInTable() {
      // Add changed product to table
      $(editRow).after(productBuildTableRow());

      // Remove original product
      $(editRow).remove();

      // Clear form fields
      formClear();

      // Change Update Button Text
      $("#updateButton").text("Add");
  }

    // Build a &lt;table&gt; row of Product data
    function productBuildTableRow() {
      var ret =
      "&lt;tr&gt;" +
      "&lt;td&gt;" +
      "&lt;button type='button' " +
      "onclick='productDisplay(this);' " +
      "class='btn btn-default'&gt;" +
      "&lt;span class='glyphicon glyphicon-edit' /&gt;" +
      "&lt;/button&gt;" +
      "&lt;/td&gt;" +
      "&lt;td&gt;" + $("#productname").val() + "&lt;/td&gt;" +
      "&lt;td&gt;" + $("#introdate").val() + "&lt;/td&gt;" +
      "&lt;td&gt;" + $("#url").val() + "&lt;/td&gt;" +
      "&lt;td&gt;" +
      "&lt;button type='button' " +
      "onclick='productDelete(this);' " +
      "class='btn btn-default'&gt;" +
      "&lt;span class='glyphicon glyphicon-remove' /&gt;" +
      "&lt;/button&gt;" +
      "&lt;/td&gt;" +
      "&lt;/tr&gt;"

      return ret;
    }

    // Delete product from &lt;table&gt;
    function productDelete(ctl) {
      $(ctl).parents("tr").remove();
    }

    // Clear form fields
    function formClear() {
      $("#productname").val("");
      $("#introdate").val("");
      $("#url").val("");
    }

    function productDisplay(ctl) {
      editRow = $(ctl).parents("tr");
      var cols = editRow.children("td");

      $("#presetname").val($(cols[1]).text());
      $("#preset_thickness").val($(cols[2]).text());
      $("#preset_length").val($(cols[3]).text());

        // Change Update Button Text
        $("#updateButton").text("Update");
    }

    function productUpdate() {
      if ($("#updateButton").text() == "Update") {
        productUpdateInTable();
      }
      else {
        productAddToTable();
      }

        // Clear form fields
        formClear();

        // Focus to product name field
        $("#presetname").focus();
    }

      // Add product to &lt;table&gt;
      function productAddToTable() {
        // First check if a &lt;tbody&gt; tag exists, add one if not
        if ($("#productTable tbody").length == 0) {
          $("#productTable").append("&lt;tbody&gt;&lt;/tbody&gt;");
        }

        // Append product to table
        $("#productTable tbody").append(
          productBuildTableRow());
    }

      // Update product in &lt;table&gt;
      function productUpdateInTable() {
        // Add changed product to table
        $(editRow).after(productBuildTableRow());

        // Remove original product
        $(editRow).remove();

        // Clear form fields
        formClear();

        // Change Update Button Text
        $("#updateButton").text("Add");
    }



      // Build a &lt;table&gt; row of Product data
      function productBuildTableRow() {
        var ret =
        "&lt;tr&gt;" +
        "&lt;td&gt;" +
        "&lt;button type='button' " +
        "onclick='productDisplay(this);' " +
        "class='btn btn-default'&gt;" +
        "&lt;span class='glyphicon glyphicon-edit' /&gt;" +
        "&lt;/button&gt;" +
        "&lt;/td&gt;" +
        "&lt;td&gt;" + $("#presetname").val() + "&lt;/td&gt;" +
        "&lt;td&gt;" + $("#preset_thickness").val() + "&lt;/td&gt;" +
        "&lt;td&gt;" + $("#preset_length").val() + "&lt;/td&gt;" +
        "&lt;td&gt;" +
        "&lt;button type='button' " +
        "onclick='productDelete(this);' " +
        "class='btn btn-default'&gt;" +
        "&lt;span class='glyphicon glyphicon-remove' /&gt;" +
        "&lt;/button&gt;" +
        "&lt;/td&gt;" +
        "&lt;/tr&gt;"

        return ret;
      }

      // Delete product from &lt;table&gt;
      function productDelete(ctl) {
        $(ctl).parents("tr").remove();
      }

      // Clear form fields
      function formClear() {
        $("#presetname").val("");
        $("#preset_thickness").val("");
        $("#preset_length").val("");
      }

$(function() {

    //const db = firebase.database().ref();
    // Initialize Firebase

    // Get a database reference to our blog
    var ref = firebase.database().ref();
    //var vall = firebase.database().ref('LED_STATUS');
    ref.update({"LED_STATUS" : "OFF"});
    ref.update({"status" : "off"});
    // make the buttons call the function below 

    ref.on('value', function(snapshot) {
      var vall = snapshot.val();
      console.log(vall);
    //document.getElementById("demo").innerHTML = vall.LED_STATUS;
  });
  });
</code></pre>
<p>Here's the CSS:</p>
<pre class="prettyprint"><code>
  input[type=range] {
  -webkit-appearance: none;
  width: 100%;
  height:15px;
  -webkit-border-radius: 1em;
  border-radius: 1em;

  -webkit-background-clip: padding;
  background-clip: padding-box;
  border: 1px solid #aaa;
  background: #eee;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 28px;
  height: 28px;
  border: 1px solid #044062;
  background: #396b9e;
  background-image: linear-gradient(#5f9cc5,#396b9e);
  -webkit-box-shadow: 0 1px 3px rgba(0,0,0,.2);
  box-shadow: 0 1px 3px rgba(0,0,0,.2);    
  cursor: pointer;
  -webkit-border-radius: 1em;
  border-radius: 1em;
  border-top: 1px solid #fff;
  border-color: rgba(255,255,255,.3);
}

button {
    font-size: 0.857em;
    padding-bottom: 0.167em;
    border: none;
    border-radius: 0.500em;
    height: 1.750em;
    width: 4.250em;
    background-color: #EB7E10;
    color: #FFF;
    cursor: pointer;
}
button.selected {
    background-color: #F2F2F2;
    border: 0.083em solid #CDCDCD;
    color: #666;
}
button.disabled {
    background-color: #FFF;
    border: 0.083em solid #F2F2F2;
    color: #D7D7D7;
}
</code></pre>
<img src="./final/site1.png" class="img-responsive margin" style="width: 100%">
<img src="./final/site2.png" class="img-responsive margin" style="width: 100%">
<p>Website url: https://pastamachine-a1af1.web.app</p>
<img src="./final/pasta.jpg" class="img-responsive margin" style="width: 100%">

<h2>Click here to see <a href="./part1.html">PART 1</a></h2>
</div>
</div>
</div>

</body>
</html>